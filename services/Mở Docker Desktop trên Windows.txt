Mở Docker Desktop trên Windows

Docker Desktop phải chạy, vì Mailcow dựa vào Docker.

Khi Docker Desktop khởi động xong → Docker daemon sẵn sàng cho WSL2.


Mở WSL2

Mở terminal WSL2 (Ubuntu của bạn) → cd ~/mailcow-dockerized

Lưu ý: Mỗi lần WSL2 restart, IP WSL2 có thể thay đổi, ví dụ 172.26.242.75 → 172.26.243.xxx


docker-compose down     # an toàn, tắt nếu có container cũ
docker-compose up -d
docker ps
wsl hostname -I
# Xóa rule cũ
netsh interface portproxy delete v4tov4 listenport=80 listenaddress=0.0.0.0
netsh interface portproxy delete v4tov4 listenport=443 listenaddress=0.0.0.0

# Thêm rule mới
netsh interface portproxy add v4tov4 listenport=80 listenaddress=0.0.0.0 connectport=80 connectaddress=<WSL_IP>
netsh interface portproxy add v4tov4 listenport=443 listenaddress=0.0.0.0 connectport=443 connectaddress=<WSL_IP>
New-NetFirewallRule -DisplayName "WSL2 Port 80" -Direction Inbound -LocalPort 80 -Protocol TCP -Action Allow
New-NetFirewallRule -DisplayName "WSL2 Port 443" -Direction Inbound -LocalPort 443 -Protocol TCP -Action Allow
sudo ss -tulpn | grep :80
sudo ss -tulpn | grep :443
curl.exe -k https://localhost
